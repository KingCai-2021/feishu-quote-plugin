# 飞书多维表格报价单生成插件

基于多维表格数据，一键生成专业报价单 PDF 文件。

## 功能特点

- ✅ 内置报价单模板（含 Logo、印章）
- 📊 自动读取多维表格数据
- 🔄 支持主从表结构（订单+产品明细）
- 💰 自动计算金额汇总
- 📦 批量导出 PDF（单独文件/合并文件）
- 🎨 支持自定义 Excel 模板

---

## 🚀 快速使用（便携版）

### 给普通用户

1. 双击 `启动服务.exe`
2. 等待窗口显示"服务已启动"
3. 在飞书多维表格中添加扩展脚本：`http://localhost:3000`
4. 开始使用！

### 打包便携版 EXE

开发者运行以下命令打包：

```bash
# 方法1：使用 pkg 打包（推荐）
build-exe.bat

# 方法2：手动打包便携版
pack-portable.bat
```

---

## 开发调试

### 方式一：本地开发

```bash
npm install
npm run dev
```

然后在飞书多维表格中：
1. 打开任意多维表格
2. 点击右侧「扩展脚本」→「添加脚本」
3. 输入地址：`http://localhost:3000`
4. 点击确定即可使用

### 方式二：部署到服务器

1. 构建项目
```bash
npm run build
```

2. 将 `dist` 目录部署到你的服务器（Nginx/Apache/Vercel/Netlify 等）

3. 在飞书多维表格中添加插件地址（必须是 HTTPS）

### 方式三：使用 Vercel 一键部署

1. Fork 此项目到你的 GitHub
2. 登录 [Vercel](https://vercel.com)
3. 点击「New Project」→ 导入你的仓库
4. 部署完成后获得 HTTPS 地址
5. 在飞书多维表格中添加该地址

### 方式四：使用 Replit

1. 访问 [Replit](https://replit.com)
2. 创建新项目，导入代码
3. 运行后获得公开地址
4. 在飞书多维表格中添加

---

## 在飞书中使用

1. 打开飞书多维表格
2. 点击右上角「...」→「扩展脚本」
3. 点击「添加脚本」
4. 输入插件地址，点击确定
5. 插件会显示在右侧边栏

![添加插件](https://example.com/add-plugin.png)

---

## 多维表格字段配置

在多维表格中创建以下字段：

| 字段名 | 类型 | 说明 |
|--------|------|------|
| 订单号 | 文本 | 如 HAMPR104 |
| 日期 | 文本/日期 | 如 27/12/2025 |
| 客户名称 | 文本 | 客户公司名 |
| 客户地址 | 文本 | 详细地址 |
| 联系人 | 文本 | 联系人姓名 |
| 电话 | 文本 | 联系电话 |
| 邮箱 | 文本 | 邮箱地址 |
| 产品明细 | 文本 | JSON 格式产品列表 |
| 定金 | 数字 | 定金金额 |
| 生产备注 | 文本 | 生产注意事项 |
| 运输条款 | 文本 | 如 FOB SHENZHEN |

### 产品明细 JSON 格式

```json
[
  {"item": "产品名称", "desc": "描述", "qty": 1000, "unit": "METERS", "price": 0.15},
  {"item": "产品名称2", "desc": "描述2", "qty": 500, "unit": "PCS", "price": 10.00}
]
```

---

## 自定义模板

1. 下载内置模板或创建新 Excel
2. 使用以下占位符：

**基本信息**
- `{{订单号}}` - 订单编号
- `{{日期}}` - 日期
- `{{客户名称}}` - 客户公司名
- `{{客户地址}}` - 地址
- `{{联系人}}` - 联系人
- `{{电话}}` - 电话
- `{{邮箱}}` - 邮箱

**产品行（会自动复制多行）**
- `{{item}}` - 产品名称
- `{{desc}}` - 描述
- `{{qty}}` - 数量
- `{{unit}}` - 单位
- `{{price}}` - 单价
- `{{total}}` - 小计

**汇总（自动计算）**
- `{{TOTAL}}` - 总金额
- `{{DEPOSIT}}` - 定金
- `{{BALANCE}}` - 余额

**备注**
- `{{生产备注}}` - 生产备注
- `{{运输条款}}` - 运输条款

---

## 常见问题

**Q: 插件加载不出来？**
A: 确保地址是 HTTPS（本地开发可用 HTTP）

**Q: 数据同步不了？**
A: 点击右上角 🔄 按钮手动同步

**Q: 产品行没有显示？**
A: 检查「产品明细」字段是否为正确的 JSON 格式

---

## 技术栈

- Vite + Vanilla JS
- @lark-base-open/js-sdk
- ExcelJS
- JSZip
